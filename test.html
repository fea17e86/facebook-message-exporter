<html>

  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Tobbis Bälch - Nachrichten</title>
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

    <!-- https://blog.twitter.com/2014/open-sourcing-twitter-emoji-for-everyone -->
    <!-- https://www.npmjs.com/package/emojione -->
  </head>

  <body>
    <div class="contents">
      <h1>Tobbis Bälch</h1>
      <div>
        <div class="thread">Tobbis Bälch, Cynthia García Belch
          <div class="message">
            <div class="message_header">
              <span class="user">Cynthia García Zermeño</span>
              <span class="meta">Sonntag, 17. August 2014 um 19:08 UTC+02</span>
            </div>
          </div>
          <p id="test1">Hahah 󾌬󾌬</p>
          <div class="message">
            <div class="message_header">
              <span class="user">Tobbis Bälch</span>
              <span class="meta">Sonntag, 17. August 2014 um 19:07 UTC+02</span>
            </div>
          </div>
          <p id="test2">pretty much 󾍇</p>
          <div class="message">
            <div class="message_header">
              <span class="user">Cynthia García Zermeño</span>
              <span class="meta">Sonntag, 17. August 2014 um 19:05 UTC+02</span>
            </div>
          </div>
          <p>Baby youre lazyy</p>
          <div class="message">
            <div class="message_header">
              <span class="user">Cynthia García Zermeño</span>
              <span class="meta">Sonntag, 17. August 2014 um 19:05 UTC+02</span>
            </div>
          </div>
          <p>Hahaha thats all you&#039;ve done since i went to sleep?</p>
          <div class="message">
            <div class="message_header">
              <span class="user">Tobbis Bälch</span>
              <span class="meta">Sonntag, 17. August 2014 um 19:01 UTC+02</span>
            </div>
          </div>
          <p>pretty good. played civ 5 for a couple of hours but i will stop soon. its enough for today 󾍇</p>
        </div>
      </div>
    </div>

    <script>
      var altHex = {
        'FE32C': '1F618',
        'FE347': '1F609'
      };

      var notFound = [];

      function emojify(text) {
        if (text) {
          var newText = '';
          var chunks = text.split(/([\uD800-\uDBFF][\uDC00-\uDFFF])/);
          for (var i=0, l=chunks.length; i<l; i++) {
            if (i % 2 === 0) {
              newText += chunks[i];
            } else {
              var pair = chunks[i];
              var hex = getHex(getCodepoint([pair.charCodeAt(0), pair.charCodeAt(1)]));
              if (hex) {
                var altHex = getAltHex(hex);
                if (altHex) {
                  hex = altHex;
                } else {
                  notFound.push(hex);
                }
                newText += '&#x' + hex + ';';
              } else {
                newTex += chunks[i];
              }
            }
          }
          return newText;
        }
        return text;
      }

      function getCodepoint(pair) {
        if (pair && pair.length > 1) {
          return (
              0x10000
              | ((pair[0] - 0xD800) << 10)
              | (pair[1] - 0xDC00)
          );
        }
        return 0;
      }

      function getHex(codepoint) {
        if (codepoint) {
          return codepoint.toString(16);
        }
        return '0';
      }

      function getAltHex(hex) {
        return altHex[hex.toUpperCase()];
      }

      $(function() {
        $('p').each(function() {
          this.innerHTML = emojify(this.innerHTML);
        });
      });
    </script>
  </body>
</html>
